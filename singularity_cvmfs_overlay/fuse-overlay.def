BootStrap: docker
From: debian:10

%post
    apt-get update -y
    apt-get install -y wget
    apt-get install -y lsb-release
    wget https://ecsft.cern.ch/dist/cvmfs/cvmfs-release/cvmfs-release-latest_all.deb
    dpkg -i cvmfs-release-latest_all.deb
    rm -f cvmfs-release-latest_all.deb
    apt-get update -y
    apt-get install -y cvmfs cvmfs-config-default cvmfs-fuse3 vim
    wget https://github.com/EESSI/filesystem-layer/releases/download/v0.2.0/cvmfs-config-esssi_0.2.0_all.deb
    dpkg -i cvmfs-config-esssi_0.2.0_all.deb
    rm -f cvmfs-config-esssi_0.2.0_all.deb
    apt-get install -y fuse-overlayfs

    cat << EOF > /etc/cvmfs/default.local
CVMFS_QUOTA_LIMIT=10000
CVMFS_HTTP_PROXY="DIRECT"
EOF

%environment
    export LC_ALL=C
